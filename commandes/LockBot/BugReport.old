const { MESSAGES } = require("../../core/constants.js")
const chalk = require('chalk')
const fs = require('fs')
const talkedRecently = new Set()

module.exports.run = async (bot, message, args) => {

    if (talkedRecently.has(message.author.id)) {
        message.channel.send("Attends 1 heure avant de renvoyer un rapport de bug - " + message.author)
    } else {

        message.delete()

        if (!args[0]) return message.channel.send('Vous n\'avez pas rentré de bug !')
        const reports = args.join(" ")
        const date = new Date()
        const date0 = date.toString()
        console.log(date0)
        const date1 = date0.replace(/:/g, '_')
        console.log(date1)
        const datereport = date1.replace(/.[0-9]{41}/, '')
        console.log(datereport)
        function callback(err) {
            if (err) throw err
        }

        fs.writeFile(`./bugreports/${datereport}.txt`, reports ,callback)
        message.channel.send("Rapport de bug envoyé ! :white_check_mark:")

    talkedRecently.add(message.author.id)
    setTimeout(() => {
      talkedRecently.delete(message.author.id)
    }, 3600000)
    }        
}



module.exports.help = MESSAGES.COMMANDS.LOCKBOT.BUGREPORT